<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Chinese New Year ¬∑ Reverse Draw</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            background: linear-gradient(145deg, #2b3a4a 0%, #1d2a35 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
            padding: 20px;
        }
        .container {
            max-width: 1300px;
            width: 100%;
            background: rgba(255,255,255,0.06);
            backdrop-filter: blur(8px);
            border-radius: 56px;
            padding: 30px;
            box-shadow: 0 30px 50px rgba(0,0,0,0.6), inset 0 2px 2px rgba(255,255,255,0.1);
            border: 1px solid rgba(255,215,0,0.2);
        }
        .main-panel {
            display: flex;
            gap: 28px;
            flex-wrap: wrap;
        }
        /* left rolling area */
        .left-panel {
            flex: 1.4;
            min-width: 360px;
            background: #0f1a24;
            border-radius: 42px;
            padding: 28px 22px;
            box-shadow: inset 0 -3px 8px #00000055, 0 20px 30px #0000004d;
            border: 1px solid #ffd96655;
            display: flex;
            flex-direction: column;
        }
        .left-panel h2 {
            color: #ffd966;
            font-weight: 500;
            letter-spacing: 2px;
            text-transform: uppercase;
            font-size: 1.4rem;
            margin-left: 12px;
            margin-bottom: 18px;
            text-shadow: 0 2px 5px #00000080;
            border-left: 6px solid #ffb347;
            padding-left: 20px;
        }
        .selector-area {
            margin-bottom: 25px;
            padding: 0 10px;
        }
        .selector-area label {
            color: #ffdb8e;
            font-size: 1.2rem;
            display: block;
            margin-bottom: 8px;
            letter-spacing: 1px;
        }
        #personSelect {
            width: 100%;
            padding: 18px 25px;
            font-size: 1.6rem;
            background: #1e2c3a;
            border: 2px solid #f1c232;
            border-radius: 60px;
            color: #fff5d6;
            font-weight: 500;
            cursor: pointer;
            outline: none;
            box-shadow: 0 6px 0 #0a121b;
            transition: 0.1s;
            appearance: none;
            background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23f1c232' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>");
            background-repeat: no-repeat;
            background-position: right 25px center;
            background-size: 30px;
        }
        #personSelect:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            border-color: #9e9e9e;
        }
        .number-roller {
            background: #091016;
            border-radius: 40px;
            padding: 40px 20px;
            margin-bottom: 30px;
            border: 2px solid #ffd96688;
            box-shadow: 0 0 20px #ffb34740, inset 0 0 10px #000000cc;
        }
        .roller-display {
            background: #1e2c3a;
            border-radius: 60px;
            padding: 35px 20px;
            text-align: center;
            border: 1px solid #f1c232;
            box-shadow: 0 8px 0 #0a121b;
        }
        #rollingNumber {
            font-size: 5rem;
            font-weight: 800;
            color: #fff5d6;
            text-shadow: 0 0 8px #ffb347, 0 4px 10px #000;
            letter-spacing: 4px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: monospace;
        }
        .btn-roll {
            background: #f5b042;
            border: none;
            border-bottom: 6px solid #9e601d;
            font-size: 2.4rem;
            font-weight: bold;
            color: #1a2a33;
            padding: 25px 20px;
            border-radius: 60px;
            width: 100%;
            cursor: pointer;
            transition: 0.1s linear;
            text-transform: uppercase;
            letter-spacing: 6px;
            box-shadow: 0 10px 20px #00000070;
            margin-top: 15px;
        }
        .btn-roll:active {
            border-bottom-width: 2px;
            transform: translateY(4px);
            background: #ffa726;
        }
        .btn-roll:disabled {
            opacity: 0.5;
            border-bottom-width: 6px;
            transform: none;
            pointer-events: none;
            filter: grayscale(0.6);
        }
        /* right winners area */
        .right-panel {
            flex: 1;
            min-width: 320px;
            background: #0f1a24e0;
            border-radius: 42px;
            padding: 28px 20px;
            border: 1px solid #e6b42266;
            box-shadow: inset 0 -3px 8px #00000070, 0 20px 30px #0000004d;
            backdrop-filter: blur(4px);
            display: flex;
            flex-direction: column;
        }
        .right-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            border-bottom: 2px dashed #f1c232;
            padding-bottom: 12px;
            margin-bottom: 24px;
            color: #ffd966;
        }
        .right-header h2 {
            font-size: 2rem;
            font-weight: 400;
            letter-spacing: 1px;
        }
        .prize-badge {
            background: #2d424b;
            padding: 8px 18px;
            border-radius: 40px;
            font-size: 1.3rem;
            font-weight: 600;
            color: #ffdb8e;
            box-shadow: inset 0 -2px 0 #1a2129;
        }
        .winners-list {
            flex: 1;
            list-style: none;
            overflow-y: auto;
            max-height: 580px;
            padding-right: 8px;
        }
        .winners-list li {
            background: #1d2f3b;
            margin: 10px 0;
            padding: 16px 22px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 15px;
            border: 1px solid #d4a259;
            box-shadow: 0 4px 0 #0f1a1f;
            font-size: 1.35rem;
            color: #fbe6b0;
            transition: 0.2s;
        }
        .winner-name {
            flex: 1;
            font-weight: 500;
        }
        .prize-tag {
            background: #c28d3b;
            color: #0b0f14;
            font-weight: 700;
            padding: 5px 18px;
            border-radius: 40px;
            font-size: 1.3rem;
            box-shadow: inset 0 -2px 0 #6d4f2a;
            border: 1px solid #fad27a;
            margin-right: 6px;
        }
        .empty-winners {
            color: #68747d;
            text-align: center;
            margin-top: 50px;
            font-size: 1.5rem;
            font-style: italic;
            opacity: 0.8;
        }
        .reset-area {
            margin-top: 25px;
            display: flex;
            justify-content: flex-end;
        }
        #resetBtn {
            background: #374952;
            border: none;
            border-bottom: 4px solid #1d2b33;
            color: #e1cd9c;
            font-size: 1.4rem;
            padding: 12px 32px;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.1s;
            letter-spacing: 2px;
        }
        #resetBtn:active {
            border-bottom-width: 1px;
            transform: translateY(3px);
            background: #2f3d47;
        }
        .remaining-count {
            font-size: 1.2rem;
            color: #ffd58c;
            background: #1d2a33;
            border-radius: 30px;
            padding: 8px 22px;
            display: inline-block;
            border: 1px solid #f5b842;
        }
        footer {
            text-align: center;
            color: #a5b9c9;
            margin-top: 20px;
            opacity: 0.7;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="main-panel">
        <!-- left rolling area - NUMBERS roll -->
        <div class="left-panel">
            <h2>üé∞ 2026 Chinese New Year ¬∑ Reverse Draw</h2>
            
            <!-- Person selector -->
            <div class="selector-area">
                <label>üë§ Select participant:</label>
                <select id="personSelect"></select>
            </div>

            <div class="number-roller">
                <div class="roller-display">
                    <div id="rollingNumber">üé≤ --</div>
                </div>
            </div>
            <button class="btn-roll" id="rollBtn">‚ñ∂ START ROLL</button>
            <div style="margin-top: 20px; display: flex; justify-content: center;">
                <span class="remaining-count" id="remainingCounter">24 numbers left</span>
            </div>
        </div>

        <!-- right winners list (NAME + PRIZE NUMBER) -->
        <div class="right-panel">
            <div class="right-header">
                <h2>üèÜ WINNERS ¬∑ NAME + NUMBER</h2>
                <span class="prize-badge" id="awardCount">0 / 24</span>
            </div>
            <!-- winners list container -->
            <ul class="winners-list" id="winnersList">
                <li class="empty-winners">‚ú® Select a person, then draw a number ‚ú®</li>
            </ul>
            <div class="reset-area">
                <button id="resetBtn">‚ü≤ RESET ALL</button>
            </div>
        </div>
    </div>
    <footer>One number per person ¬∑ Numbers 01-24 ¬∑ Everyone gets a unique number</footer>
</div>

<script>
    (function() {
        // ---------- Original name list (24 people) ----------
        const fullNameList = [
            "Ethan Chuu", "Jessie Tew", "Wong Chok Poh", "Victor So", "Lee Lung Chay",
            "Cyril Chan", "Han Lin Maung", "Aung Thant", "Myo Min Naing", "Shirley Tew",
            "Paing Soe", "Wai Phyo", "Albert", "Luna", "Edika",
            "Bunyau", "Terrence", "Ocean Chuu", "Kuan", "Ghan",
            "Ko Gyi", "Zue Hilaing Htoo", "Tun Myint Aung", "Zheng Hui"
        ];
        
        // State
        let availableNumbers = [];           // numbers that haven't been drawn yet (as strings "01".."24")
        let availablePeople = [...fullNameList];  // people who haven't won yet
        let winners = [];                    // { name, number } array
        
        let isRolling = false;
        let rollInterval = null;
        let currentDisplayNumber = "--";      // current number showing in roller
        
        // DOM elements
        const personSelect = document.getElementById('personSelect');
        const rollingNumberEl = document.getElementById('rollingNumber');
        const rollBtn = document.getElementById('rollBtn');
        const winnersListEl = document.getElementById('winnersList');
        const remainingCounterEl = document.getElementById('remainingCounter');
        const awardCountEl = document.getElementById('awardCount');
        const resetBtn = document.getElementById('resetBtn');

        // Initialize numbers 01 to 24
        function initNumbers() {
            availableNumbers = [];
            for (let i = 1; i <= fullNameList.length; i++) {
                availableNumbers.push(i.toString().padStart(2, '0'));
            }
        }
        initNumbers();  // initial call

        // Populate dropdown with available people
        function populateDropdown() {
            const options = [];
            for (let person of availablePeople) {
                options.push(`<option value="${person}">${person}</option>`);
            }
            personSelect.innerHTML = options.join('');
            
            // Disable dropdown if no people left
            if (availablePeople.length === 0) {
                personSelect.disabled = true;
                personSelect.innerHTML = '<option>üéâ All winners selected</option>';
            } else {
                personSelect.disabled = false;
            }
        }

        // Update remaining counts display
        function updateCounts() {
            remainingCounterEl.textContent = `${availableNumbers.length} numbers left`;
            awardCountEl.textContent = `${winners.length} / ${fullNameList.length}`;
        }

        // Render winners list (name + number)
        function renderWinners() {
            if (winners.length === 0) {
                winnersListEl.innerHTML = '<li class="empty-winners">‚ú® Select a person, then draw a number ‚ú®</li>';
            } else {
                const items = winners.map(winner => {
                    return `<li>
                        <span class="winner-name">${winner.name}</span>
                        <span class="prize-tag">#${winner.number}</span>
                    </li>`;
                }).join('');
                winnersListEl.innerHTML = items;
                // Scroll to bottom
                winnersListEl.scrollTop = winnersListEl.scrollHeight;
            }
            updateCounts();
        }

        // Get random number from availableNumbers
        function getRandomAvailableNumber() {
            if (availableNumbers.length === 0) return "üéØ ALL DONE";
            const randomIdx = Math.floor(Math.random() * availableNumbers.length);
            return availableNumbers[randomIdx];
        }

        // Update rolling display (called by interval)
        function updateRollingDisplay() {
            if (availableNumbers.length === 0) {
                rollingNumberEl.textContent = "üéØ NO NUMBERS";
                return;
            }
            const randomNum = getRandomAvailableNumber();
            currentDisplayNumber = randomNum;
            rollingNumberEl.textContent = randomNum;
        }

        // Start rolling numbers
        function startRolling() {
            // Check if a person is selected
            if (!personSelect.value || personSelect.disabled) {
                alert('Please select a participant first.');
                return;
            }
            
            if (availableNumbers.length === 0) {
                alert('No numbers left to draw! Click RESET to start over.');
                rollBtn.textContent = '‚ñ∂ START ROLL';
                isRolling = false;
                return;
            }

            if (rollInterval) clearInterval(rollInterval);
            rollInterval = setInterval(updateRollingDisplay, 70);
            isRolling = true;
            rollBtn.textContent = '‚èπ STOP DRAW';
        }

        // Stop rolling and assign current number to selected person
        function stopAndPickNumber() {
            if (rollInterval) {
                clearInterval(rollInterval);
                rollInterval = null;
            }
            isRolling = false;
            rollBtn.textContent = '‚ñ∂ START ROLL';

            // Double-check: person selected?
            if (!personSelect.value || personSelect.disabled) {
                alert('Please select a valid participant.');
                return;
            }

            if (availableNumbers.length === 0) {
                rollingNumberEl.textContent = "üéØ ALL NUMBERS GONE";
                return;
            }

            // Get selected person
            const selectedPerson = personSelect.value;
            
            // Verify person is still available (should be, but safety)
            if (!availablePeople.includes(selectedPerson)) {
                alert('This person already won! Please select another.');
                populateDropdown(); // refresh dropdown
                return;
            }

            // Current displayed number (from rolling)
            let pickedNumber = currentDisplayNumber;

            // Validate that pickedNumber is actually in availableNumbers
            if (!availableNumbers.includes(pickedNumber)) {
                // If not, pick first available as fallback
                if (availableNumbers.length > 0) {
                    pickedNumber = availableNumbers[0];
                } else {
                    return;
                }
            }

            // Remove the number from availableNumbers
            const numIndex = availableNumbers.indexOf(pickedNumber);
            if (numIndex !== -1) {
                availableNumbers.splice(numIndex, 1);
            } else {
                // fallback
                pickedNumber = availableNumbers[0];
                availableNumbers.shift();
            }

            // Remove person from availablePeople
            const personIndex = availablePeople.indexOf(selectedPerson);
            if (personIndex !== -1) {
                availablePeople.splice(personIndex, 1);
            }

            // Add to winners
            winners.push({ name: selectedPerson, number: pickedNumber });

            // Update display to show picked number
            rollingNumberEl.textContent = pickedNumber;

            // If no numbers left, update message
            if (availableNumbers.length === 0) {
                rollingNumberEl.textContent = "üéâ ALL NUMBERS DRAWN üéâ";
                if (rollInterval) {
                    clearInterval(rollInterval);
                    rollInterval = null;
                }
                isRolling = false;
                rollBtn.textContent = '‚ñ∂ START ROLL';
            }

            // Refresh dropdown (remove selected person)
            populateDropdown();

            // Re-render winners list
            renderWinners();
        }

        // Handle roll button click
        function handleRollClick() {
            // Edge case: no numbers left
            if (availableNumbers.length === 0 && !isRolling) {
                alert('All numbers have been drawn! Click RESET to start over.');
                return;
            }

            // Edge case: no people left
            if (availablePeople.length === 0 && !isRolling) {
                alert('Everyone has already won a number! Click RESET.');
                return;
            }

            if (isRolling) {
                stopAndPickNumber();
            } else {
                startRolling();
            }
        }

        // Reset everything
        function resetGame() {
            // Stop any rolling
            if (rollInterval) {
                clearInterval(rollInterval);
                rollInterval = null;
            }
            isRolling = false;
            rollBtn.textContent = '‚ñ∂ START ROLL';

            // Reset state
            availablePeople = [...fullNameList];
            winners = [];
            initNumbers();  // reset numbers 01-24
            
            // Reset display
            currentDisplayNumber = "--";
            rollingNumberEl.textContent = "üé≤ --";

            // Refresh dropdown
            populateDropdown();

            // Re-render winners (empty)
            renderWinners();
        }

        // Initial setup
        function init() {
            populateDropdown();
            renderWinners();
            rollBtn.addEventListener('click', handleRollClick);
            resetBtn.addEventListener('click', resetGame);

            window.addEventListener('beforeunload', function() {
                if (rollInterval) clearInterval(rollInterval);
            });
        }

        init();
    })();
</script>
</body>
</html>
